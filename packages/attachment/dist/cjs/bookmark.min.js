"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),n=(e=t)&&"object"==typeof e&&"default"in e?e.default:e,o=require("@react-pdf-viewer/core"),r=function(e){var o=e.bookmark,r=e.depth,a=e.doc,i=e.onClick,s=e.onJumpToDest,u=t.createRef(),l=t.createRef(),m=t.useRef(!0),d=o.items&&o.items.length>0;return n.createElement(n.Fragment,null,n.createElement("div",{className:"rpv-bookmark-item",style:{paddingLeft:20*r+4+"px"},onClick:function(){!d&&o.dest&&i(o.dest)}},d&&n.createElement("span",{ref:u,className:"rpv-bookmark-toggle",onClick:function(){m.current=!m.current;var e=l.current,t=u.current;e&&t&&(e.style.display=m.current?"block":"none",t.classList.toggle("rpv-bookmark-toggle-expanded"))}},"â–º"),o.url?n.createElement("a",{className:"rpv-bookmark-title",href:o.url,rel:"noopener noreferrer nofollow",target:o.newWindow?"_blank":""},o.title):n.createElement("div",{className:"rpv-bookmark-title",onClick:function(){d&&o.dest&&i(o.dest)}},o.title)),d&&n.createElement("div",{ref:l},n.createElement(c,{bookmarks:o.items,depth:r+1,doc:a,onJumpToDest:s})))},a=function(e,t){return new Promise((function(n){new Promise((function(n){"string"==typeof t?e.getDestination(t).then((function(e){n(e)})):n(t)})).then((function(t){e.getPageIndex(t[0]).then((function(e){var r=function(e,t){switch(t[1].name){case"XYZ":return{bottomOffset:t[3],pageIndex:e-1,scaleTo:t[4]};case"Fit":return{bottomOffset:0,pageIndex:e-1,scaleTo:o.SpecialZoomLevel.PageFit};default:return{bottomOffset:0,pageIndex:e-1,scaleTo:1}}}(e,t);n(r)}))}))}))},c=function(e){var t=e.bookmarks,o=e.depth,c=void 0===o?0:o,i=e.doc,s=e.onJumpToDest,u=function(e){a(i,e).then((function(e){var t=e.pageIndex,n=e.bottomOffset,o=e.scaleTo;s(t+1,n,o)}))};return n.createElement("ul",{className:"rpv-bookmark-list"},t.map((function(e,t){return n.createElement("li",{key:t},n.createElement(r,{bookmark:e,depth:c,doc:i,onClick:u,onJumpToDest:s}))})))},i=function(e){var r=e.doc,a=e.onJumpToDest,i=t.useContext(o.LocalizationContext),s=t.useState({isLoaded:!1,items:[]}),u=s[0],l=s[1];return t.useEffect((function(){l({isLoaded:!1,items:[]}),r.getOutline().then((function(e){l({isLoaded:!0,items:e||[]})}))}),[r]),u.isLoaded?0===u.items.length?n.createElement("div",{className:"rpv-bookmark-empty"},i&&i.plugins&&i.plugins.bookmark?i.plugins.bookmark.noBookmark:"There is no bookmark"):n.createElement(c,{bookmarks:u.items,depth:0,doc:r,onJumpToDest:a}):n.createElement(o.Spinner,null)},s=function(e){var r=e.store,a=t.useState(r.get("doc")),c=a[0],s=a[1],u=function(e){s(e)};return t.useEffect((function(){return r.subscribe("doc",u),function(){r.unsubscribe("doc",u)}}),[]),c?n.createElement(i,{doc:c,onJumpToDest:function(e,t,n){var o=r.get("jumpToDestination");o&&o(e,t,n)}}):n.createElement("div",{className:"rpv-bookmark-list-loader"},n.createElement(o.Spinner,null))};exports.default=function(){var e=o.createStore({});return{install:function(t){e.update("jumpToDestination",t.jumpToDestination)},onDocumentLoad:function(t){e.update("doc",t.doc)},Bookmarks:function(){return n.createElement(s,{store:e})}}};
